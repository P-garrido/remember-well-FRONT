<section>
  <article class="photos">

    <img [src]="profile.backPicUrl=== this.url + '/null' ? '../../assets/portada-defecto.webp': profile.backPicUrl"
      alt="Foto de portada" class="backp">

    <img [src]="profile.profilePicUrl=== this.url + '/null' ? '../../assets/perfil-defecto.webp': profile.profilePicUrl"
      alt="Foto de perfil" class="pfp">

  </article>



  <article class="description">
    <p>{{profile.name || ''}}</p>

    <p>{{profile.birthDate| date: 'dd/MM/yyy'}} - {{profile.deathDate| date: 'dd/MM/yyy'}}</p>



    <button *ngIf="this.loginService.user && editorIds.includes(this.loginService.user.id)" class="btn"
      (click)="editProfile()">Editar Perfil</button>
    <button *ngIf="this.loginService.user && this.profile.idOwner == this.loginService.user!.id" class="btn"
      (click)="openModal(adminEditors)">Administrar Editores</button>

  </article>



</section>


<section class="tabs">
  <tabset [justified]="true">
    <tab heading="En memoria de" customClass="about-me">
      <a *ngIf="profile.link" href="{{profile.link}}" target="_blank">Link personalizado</a>
      <p>
        {{profile.aboutMe || ''}}
      </p>
    </tab>
    <tab heading="Galería">
      <button *ngIf="!onEditFiles && this.loginService.user && editorIds.includes(this.loginService.user.id)"
        class="btn" (click)="this.onEditFiles=true">Editar Archivos</button>
      <button *ngIf="onEditFiles" class="btn" (click)="addFiles()">Aceptar</button>


      <div *ngIf="onEditFiles" class="form-floating mb-3 input-galeria">
        <input type="file" class="form-control" id="floatingInput" placeholder="Archivo"
          accept=".mp3, .mp4, .png, .jpg, .jpeg" multiple #inputGaleria>
        <label for="floatingInput">Sube tus fotos y videos</label>
      </div>

      <app-galeria [galleryData]="profile.filesGallery" [showCount]="true" [onEdit]="onEditFiles"
        [owner]="this.loginService.user && this.loginService.user && editorIds.includes(this.loginService.user.id)"
        (deleteFile)="deleteFile($event)"></app-galeria>
    </tab>
    <tab heading="Tributos">

      <article class="userTrib">
        <div class="form-floating">
          <textarea class="form-control" placeholder="Dejá tu comentario" id="floatingTextarea2" style="height: 100px"
            [formControl]="tribute"></textarea>
          <label for="floatingTextarea2">Dejá tu comentario</label>
        </div>
        <div *ngIf="!loginService.user" class="form-floating mb-3">
          <input type="text" class="form-control" id="floatingInput2" placeholder="Deja tu nombre (opcional)"
            [formControl]="name">
          <label for="floatingInput2">Deja tu nombre (opcional)</label>
        </div>
        <button (click)="sendTribute()" class="btn btn-comment" [disabled]="!tribute.valid">Enviar</button>

      </article>


      <div *ngFor="let trib of profile.tributes">
        <app-tributo [tribute]="trib"
          [owner]="this.loginService.user && this.loginService.user && editorIds.includes(this.loginService.user.id)"
          (deleteTribute)="deleteTribute($event)"></app-tributo>
      </div>
    </tab>
  </tabset>
</section>







<ng-template #adminEditors>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Administrar editores</h4>
    <button type="button" class="btn-close close pull-right" aria-label="Close" (click)="modalRef?.hide()">
      <span aria-hidden="true" class="visually-hidden">&times;</span>
    </button>
  </div>
  <div class="modal-body">

    <div class="form-floating mb-3">
      <input type="email" class="form-control form-input" id="floatingInput" placeholder="Mail"
        [formControl]="mailEditor">
      <label for="floatingInput">Mail</label>
    </div>

    <button class="btn" [disabled]="!mailEditor.valid" (click)="addEditor()">Agregar</button>

    <section class="editores">

      <div class="editor" *ngFor="let editor of profile.editors">
        <!-- aca van a ir los editores  -->

        <p>{{editor.name}} - ({{editor.mail}})</p>
        <button [disabled]="editor.id==profile.idOwner" (click)="removeEditor(editor.id)"
          class="btn btn-eliminar">Quitar</button>

      </div>

    </section>


  </div>
</ng-template>